# 股票价格预测系统

一个基于深度学习的股票价格预测系统，集成了Tushare金融数据平台，使用基线LSTM模型进行未来五天的价格预测并支持数据可视化功能。

## 系统功能

1. **数据获取**：通过Tushare API获取股票历史数据并保存到本地
2. **模型训练**：使用简化的基线LSTM深度学习模型进行训练
3. **单只股票预测**：使用训练好的模型预测单只股票的未来五天价格
4. **批量股票预测**：同时预测多只股票的未来五天价格并支持结果导出
5. **数据可视化**：展示预测结果与实际价格的对比图表
<img width="1910" height="923" alt="4160a910-3a96-46bd-ab28-a8345ffad42c" src="https://github.com/user-attachments/assets/728c1466-d0a3-4c22-83d5-f1f3466e34fc" />
<img width="1030" height="655" alt="image" src="https://github.com/user-attachments/assets/b8bf39cf-c99d-4319-9e69-192ef91ddef0" />


## 环境准备

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **配置Tushare API**
   - 系统已在`config.py`中配置了默认的Tushare API token
   - 如需更换token，请修改`config.py`中的`TUSHARE_TOKEN`变量

3. **项目目录结构**
   ```
   stock_predictor/
   ├── app.py               # Flask Web应用入口
   ├── main.py              # 命令行主程序入口
   ├── config.py            # 系统配置文件
   ├── stock_data.py        # 数据获取与处理模块
   ├── stock_model.py       # 模型定义模块
   ├── train_stock_model.py # 模型训练模块
   ├── predict_stock.py     # 预测模块
   ├── requirements.txt     # 依赖包列表
   ├── start_server.bat     # 启动服务器批处理文件
   ├── data/                # 股票数据存储目录
   ├── models/              # 训练好的模型存储目录
   ├── plots/               # 图表存储目录
   ├── results/             # 预测结果存储目录
   ├── static/              # 前端静态资源
   │   ├── css/             # CSS样式文件
   │   └── js/              # JavaScript脚本
   └── templates/           # Web界面模板
   ```

## 使用方法

### 通过命令行运行

```bash
python main.py
```

### 通过Web界面运行

1. **启动Web服务器**
   ```bash
   python app.py
   ```
   或双击运行`start_server.bat`批处理文件

2. **访问界面**
   在浏览器中访问 `http://localhost:5000` 打开可视化界面

3. **使用Web界面功能**
   - **数据看板**：查看系统状态和基本信息
   - **获取数据**：获取并保存股票历史数据
   - **训练模型**：训练股票预测模型
   - **股票预测**：预测单只股票的未来五天价格
   - **批量预测**：同时预测多只股票的未来五天价格
   - **模型管理**：查看和管理已训练的模型

## 系统配置

所有配置参数都集中在`config.py`文件中，包括：

- **数据配置**：Tushare API token、数据目录、默认日期范围
- **模型配置**：默认模型类型、隐藏层大小、层数等
- **训练配置**：序列长度、批次大小、学习率、训练轮数等
- **预测配置**：预测未来天数(`PREDICTION_HORIZON = 5`)

## 技术实现

1. **数据处理**：使用pandas和numpy进行数据清洗、特征工程和归一化
2. **模型构建**：基于PyTorch框架实现深度学习模型
3. **模型优化**：实现了早停机制和学习率调度，避免过拟合
4. **可视化**：使用matplotlib绘制预测结果图表，前端使用Chart.js实现交互式图表
5. **Web界面**：使用Flask框架构建Web应用，提供直观的用户界面

## 注意事项

1. **投资风险提示**：股票预测仅供参考，不构成任何投资建议
2. **数据更新**：系统依赖Tushare API提供数据，如遇API变更可能需要更新代码
3. **性能优化**：训练大型模型时可能需要GPU支持以提高速度
4. **模型更新**：建议定期重新训练模型以保持预测准确性
5. **参数调优**：不同股票可能需要不同的模型参数才能获得最佳预测效果
6. **股票代码格式**：
   - 深圳证券交易所：`000001.SZ`
   - 上海证券交易所：`600000.SH`

## 更新日志

### v1.3
- 更新可视化界面，明确显示"未来五天预测"信息
- 优化项目结构，删除无用文件和目录
- 更新文档，反映当前项目结构和功能

### v1.2
- 优化股票信息显示，在批量预测结果和可视化图表中同时显示股票名称和代码

### v1.1
- 简化版本，仅保留基线LSTM模型，移除了复杂LSTM和GRU模型支持

### v1.0
- 初始版本发布
- 支持LSTM、基线LSTM和GRU三种模型
- 实现单只股票预测和批量预测功能
- 提供交互式命令行界面和Web界面
- 支持数据获取和模型训练
